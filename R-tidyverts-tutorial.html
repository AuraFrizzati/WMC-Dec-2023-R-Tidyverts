<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aura Frizzati - NHS Wales Executive | Digital Intelligence)">
<meta name="dcterms.date" content="2023-12-04">

<title>R-tidyverts-tutorial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="R-tidyverts-tutorial_files/libs/clipboard/clipboard.min.js"></script>
<script src="R-tidyverts-tutorial_files/libs/quarto-html/quarto.js"></script>
<script src="R-tidyverts-tutorial_files/libs/quarto-html/popper.min.js"></script>
<script src="R-tidyverts-tutorial_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="R-tidyverts-tutorial_files/libs/quarto-html/anchor.min.js"></script>
<link href="R-tidyverts-tutorial_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="R-tidyverts-tutorial_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="R-tidyverts-tutorial_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="R-tidyverts-tutorial_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="R-tidyverts-tutorial_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="R-tidyverts-tutorial_files/libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="R-tidyverts-tutorial_files/libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="R-tidyverts-tutorial_files/libs/typedarray-0.1/typedarray.min.js"></script>
<script src="R-tidyverts-tutorial_files/libs/jquery-3.5.1/jquery.min.js"></script>
<link href="R-tidyverts-tutorial_files/libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="R-tidyverts-tutorial_files/libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="R-tidyverts-tutorial_files/libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="R-tidyverts-tutorial_files/libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="R-tidyverts-tutorial_files/libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="R-tidyverts-tutorial_files/libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="R-tidyverts-tutorial_files/libs/dygraphs-1.1.1/shapes.js"></script>
<script src="R-tidyverts-tutorial_files/libs/moment-2.8.4/moment.js"></script>
<script src="R-tidyverts-tutorial_files/libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="R-tidyverts-tutorial_files/libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="R-tidyverts-tutorial_files/libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#intro-tidyverts-packages" id="toc-intro-tidyverts-packages" class="nav-link active" data-scroll-target="#intro-tidyverts-packages">1. Intro: Tidyverts packages</a></li>
  <li><a href="#data-retrieval" id="toc-data-retrieval" class="nav-link" data-scroll-target="#data-retrieval">2. Data retrieval</a></li>
  <li><a href="#data-cleaning" id="toc-data-cleaning" class="nav-link" data-scroll-target="#data-cleaning">3. Data cleaning</a></li>
  <li><a href="#conversion-into-a-tsibble" id="toc-conversion-into-a-tsibble" class="nav-link" data-scroll-target="#conversion-into-a-tsibble">4. Conversion into a <code>tsibble</code></a></li>
  <li><a href="#time-series-plotting" id="toc-time-series-plotting" class="nav-link" data-scroll-target="#time-series-plotting">5. Time series plotting</a>
  <ul class="collapse">
  <li><a href="#time-lines" id="toc-time-lines" class="nav-link" data-scroll-target="#time-lines">5.1 Time lines</a></li>
  <li><a href="#interactive-time-lines" id="toc-interactive-time-lines" class="nav-link" data-scroll-target="#interactive-time-lines">5.2 Interactive Time lines</a></li>
  <li><a href="#seasonal-plots" id="toc-seasonal-plots" class="nav-link" data-scroll-target="#seasonal-plots">5.2 Seasonal plots</a></li>
  </ul></li>
  <li><a href="#time-series-decomposition" id="toc-time-series-decomposition" class="nav-link" data-scroll-target="#time-series-decomposition">5. Time series decomposition</a></li>
  <li><a href="#forecasting" id="toc-forecasting" class="nav-link" data-scroll-target="#forecasting">6. Forecasting</a>
  <ul class="collapse">
  <li><a href="#create-training-and-validation-periods" id="toc-create-training-and-validation-periods" class="nav-link" data-scroll-target="#create-training-and-validation-periods">6.1 Create Training and Validation periods</a></li>
  <li><a href="#fit-a-model-to-the-training-data" id="toc-fit-a-model-to-the-training-data" class="nav-link" data-scroll-target="#fit-a-model-to-the-training-data">6.2 Fit a model to the Training data</a></li>
  <li><a href="#forecast" id="toc-forecast" class="nav-link" data-scroll-target="#forecast">6.3 Forecast</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">R-tidyverts-tutorial</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Aura Frizzati - NHS Wales Executive | Digital Intelligence) </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">December 4, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## load relevant libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## from tidyverse</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)    <span class="do">## data wrangling</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)  <span class="do">## handling of strings</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)    <span class="do">## functional programming</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)    <span class="do">## r objects' import/export</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)  <span class="do">## r plotting</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## from tidyverts</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tsibble)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fable)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fabletools)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(feasts)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## others</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(statswalesr) <span class="do">## import data from StatsWales</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly) <span class="do">## interactive ggplots</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt) <span class="do">## html table formatting</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(renv) <span class="do">## create r environment for sharing</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">999</span>) <span class="do">## remove scientific notation</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="intro-tidyverts-packages" class="level2">
<h2 class="anchored" data-anchor-id="intro-tidyverts-packages">1. Intro: Tidyverts packages</h2>
<p>They are “tidy” tools created to handle time series (<a href="https://tidyverts.org/">tidyverts.org</a>). They are based on and extend the <a href="https://www.tidyverse.org/">tidyverse</a> collection of packages.</p>
<p><img src="img/tidiverts_family.JPG" class="img-fluid"></p>
<p><em>Add something about what time series are and other packages available in R to handle them</em></p>
<p>use of new tibble pipe operator <a href="https://www.rforecology.com/post/how-to-use-pipes/" class="uri">https://www.rforecology.com/post/how-to-use-pipes/</a></p>
</section>
<section id="data-retrieval" class="level2">
<h2 class="anchored" data-anchor-id="data-retrieval">2. Data retrieval</h2>
<p>We will trial some of them on data retrieved from <a href="https://statswales.gov.wales/Catalogue">StatsWales</a>.</p>
<p>We will retrieve “<a href="https://statswales.gov.wales/Catalogue/Health-and-Social-Care/NHS-Hospital-Waiting-Times/emergency-department/emergencyattendances-by-age-sex-site"><strong><code>Number of attendances in NHS Wales emergency departments by age band, sex and site</code></strong></a>”.</p>
<p>These are aggregated monthly attendances to Emergency Dept (ED), partitioned by:</p>
<ul>
<li>Local Health Board &amp; Hospital Site</li>
<li>Patient Sex</li>
<li>Patient Age group.</li>
</ul>
<p>We can directly extract the whole dataset in R using the <code>statswalesr</code> <a href="https://github.com/jamie-ralph/statswalesr">package</a>, using the Open Data table code (HLTH0037)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## **</span><span class="al">WARNING</span><span class="do">: this step might take some time**</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_raw <span class="ot">&lt;-</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  statswalesr<span class="sc">::</span><span class="fu">statswales_get_dataset</span>(<span class="st">"HLTH0037"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>HLTH0037_metadata <span class="ot">&lt;-</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  statswalesr<span class="sc">::</span><span class="fu">statswales_get_metadata</span>(<span class="st">"HLTH0037"</span>, <span class="at">language =</span> <span class="st">"english"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-cleaning" class="level2">
<h2 class="anchored" data-anchor-id="data-cleaning">3. Data cleaning</h2>
<ul>
<li><p>Removed redundant columns</p></li>
<li><p>Modified columns’ names</p></li>
<li><p>Attached Local Health Boards’ names to geographical codes (lookup retrieved from Gov Wales <a href="https://view.officeapps.live.com/op/view.aspx?src=https%3A%2F%2Fwww.gov.wales%2Fsites%2Fdefault%2Ffiles%2Fstatistics-and-research%2F2021-09%2Fsensory-health-eye-care-and-hearing-statistics-april-2019-march-2021-tables-221.ods&amp;wdOrigin=BROWSELINK">Table 9</a>)</p></li>
<li><p>Aggregated some of the age groups</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(HLTH0037_data_raw, <span class="st">"data/HLTH0037_data_raw.csv"</span>, <span class="at">row.names =</span> F)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(HLTH0037_metadata, <span class="st">"data/HLTH0037_metadata.csv"</span>, <span class="at">row.names =</span> F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] re-import the data saved locally</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_raw <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/HLTH0037_data_raw.csv"</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>HLTH0037_metadata <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/HLTH0037_metadata.csv"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#names(HLTH0037_data_raw)</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [2] Select only relevant folumns and rename them</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>HLTH0037_data <span class="ot">&lt;-</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_raw <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    Date_ItemName_ENG,       <span class="do">## Time as Month&amp;Year</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    Data,                    <span class="do">## Number of ED Attendances</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    Hospital_ItemName_ENG,   <span class="do">## Hospital name</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    Hospital_Hierarchy,      <span class="do">## Local Health Board code</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    Age_ItemName_ENG,        <span class="do">## Age groups</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    Sex_ItemName_ENG         <span class="do">## Sex groups</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="do">## rename the columns</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">MonthYear =</span> Date_ItemName_ENG,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">Attendances =</span> Data,</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">Hospital =</span> Hospital_ItemName_ENG,</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">LHB_code =</span> Hospital_Hierarchy,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_band =</span> Age_ItemName_ENG,</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">Sex =</span> Sex_ItemName_ENG</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Check the filtered data</span></span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HLTH0037_data) <span class="sc">|&gt;</span> </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span> <span class="do">## transforming the data into a table with specified formatting</span></span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">12</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  [3] create the lookup for LHB names/codes and attach the LHB names to ED data</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>NHSWalesOrg_lookup <span class="ot">&lt;-</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Organisation"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"Betsi Cadwaladr"</span>, </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Powys Teaching"</span>, </span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Hywel Dda"</span>, </span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Swansea Bay"</span>,</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Abertawe Bro Morgannwg"</span>, </span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Cwm Taf Morgannwg"</span>,</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Cwm Taf"</span>, </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Aneurin Bevan"</span>,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Cardiff &amp; Vale"</span>, </span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                       <span class="st">"Wales"</span>),</span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Geographical_code"</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"W11000023"</span>, </span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000024"</span>,</span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000025"</span>, </span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000031"</span>,</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000026"</span>, </span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000030"</span>,</span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000027"</span>, </span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000028"</span>,</span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W11000029"</span>, </span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>                            <span class="st">"W92000004"</span>))</span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>NHSWalesOrg_lookup <span class="sc">|&gt;</span> </span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">12</span>)</span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_v2 <span class="ot">&lt;-</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data <span class="sc">|&gt;</span></span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(</span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>    NHSWalesOrg_lookup,</span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"LHB_code"</span> <span class="ot">=</span> <span class="st">"Geographical_code"</span>))</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HLTH0037_data_v2) <span class="sc">|&gt;</span> </span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">12</span>)</span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a><span class="do">## [4] Look at the summary of the variables in the table</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>unique_values<span class="ot">&lt;-</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_v2 <span class="sc">|&gt;</span> </span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Organisation,Age_band,Sex,Hospital,MonthYear) <span class="sc">|&gt;</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(</span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span> stringr<span class="sc">::</span><span class="fu">str_c</span>(<span class="fu">unique</span>(.x), <span class="do">## distinct values/column</span></span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>         <span class="at">collapse =</span> <span class="st">","</span>)) <span class="sc">|&gt;</span></span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>() <span class="sc">|&gt;</span> </span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">`</span><span class="at">Col name</span><span class="st">`</span>, <span class="at">value =</span> <span class="st">`</span><span class="at">Unique values</span><span class="st">`</span>) </span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>N_unique_values<span class="ot">&lt;-</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_v2 <span class="sc">|&gt;</span></span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Organisation,Age_band,Sex,Hospital,MonthYear) <span class="sc">|&gt;</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">length</span>(<span class="fu">unique</span>(.x)))<span class="sc">|&gt;</span> <span class="do">## n distinct values/column</span></span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(</span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">`</span><span class="at">Col name</span><span class="st">`</span>, <span class="at">value =</span> <span class="st">`</span><span class="at">N unique values</span><span class="st">`</span>)</span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>N_missing_values<span class="ot">&lt;-</span></span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_v2 <span class="sc">|&gt;</span></span>
<span id="cb4-94"><a href="#cb4-94" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Organisation,Age_band,Sex,Hospital,MonthYear) <span class="sc">|&gt;</span></span>
<span id="cb4-95"><a href="#cb4-95" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(<span class="fu">is.na</span>(.x)))<span class="sc">|&gt;</span> <span class="do">## n missing values/column</span></span>
<span id="cb4-96"><a href="#cb4-96" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-97"><a href="#cb4-97" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(</span>
<span id="cb4-98"><a href="#cb4-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">`</span><span class="at">Col name</span><span class="st">`</span>, <span class="at">value =</span> <span class="st">`</span><span class="at">N missing values</span><span class="st">`</span>) </span>
<span id="cb4-99"><a href="#cb4-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-100"><a href="#cb4-100" aria-hidden="true" tabindex="-1"></a>class_variables <span class="ot">&lt;-</span></span>
<span id="cb4-101"><a href="#cb4-101" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_v2 <span class="sc">|&gt;</span></span>
<span id="cb4-102"><a href="#cb4-102" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Organisation,Age_band,Sex,Hospital,MonthYear) <span class="sc">|&gt;</span></span>
<span id="cb4-103"><a href="#cb4-103" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">class</span>(.x))<span class="sc">|&gt;</span> <span class="do">## extract variable class/column</span></span>
<span id="cb4-104"><a href="#cb4-104" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">bind_rows</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-105"><a href="#cb4-105" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">gather</span>(</span>
<span id="cb4-106"><a href="#cb4-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="st">`</span><span class="at">Col name</span><span class="st">`</span>, <span class="at">value =</span> Class) </span>
<span id="cb4-107"><a href="#cb4-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-108"><a href="#cb4-108" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(</span>
<span id="cb4-109"><a href="#cb4-109" aria-hidden="true" tabindex="-1"></a>  unique_values,</span>
<span id="cb4-110"><a href="#cb4-110" aria-hidden="true" tabindex="-1"></a>  N_unique_values<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">N unique values</span><span class="st">`</span>),</span>
<span id="cb4-111"><a href="#cb4-111" aria-hidden="true" tabindex="-1"></a>  N_missing_values<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="st">`</span><span class="at">N missing values</span><span class="st">`</span>),</span>
<span id="cb4-112"><a href="#cb4-112" aria-hidden="true" tabindex="-1"></a>  class_variables<span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Class)</span>
<span id="cb4-113"><a href="#cb4-113" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span></span>
<span id="cb4-114"><a href="#cb4-114" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb4-115"><a href="#cb4-115" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-116"><a href="#cb4-116" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">cols_align</span>(<span class="at">align =</span> <span class="st">"left"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## [5] Final changes: aggregate age groups, convert time column from character into date format (monthly), shorten LHB names, group Attendances counts by all variables' combinations (MonthYear x Hospital X Age group X Sex) </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="do">## **</span><span class="al">WARNING</span><span class="do">: this step might take some time**</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_v3 <span class="ot">&lt;-</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_v2 <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Aggregating age groups within Age_band</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">Age_band =</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>      dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>        Age_band <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"0-4"</span>,<span class="st">"5-17"</span>) <span class="sc">~</span> <span class="st">"0-17"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>        Age_band <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"18-24"</span>,<span class="st">"25-29"</span>,<span class="st">"30-34"</span>,<span class="st">"35-39"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"40-44"</span>,<span class="st">"45-49"</span>,<span class="st">"50-54"</span>,<span class="st">"55-59"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>                        <span class="st">"60-64"</span>,<span class="st">"65-69"</span>) <span class="sc">~</span> <span class="st">"18-69"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>        Age_band <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"70-74"</span>,<span class="st">"75-79"</span>,<span class="st">"80-84"</span>,<span class="st">"85 and over"</span>) <span class="sc">~</span> <span class="st">"70+"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> Age_band),</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Converting MonthYear column from character to date format</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">MonthYear =</span> tsibble<span class="sc">::</span><span class="fu">yearmonth</span>(MonthYear),</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Convert LHB full names into shorter ones</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">LHB =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Aneurin Bevan"</span> <span class="sc">~</span> <span class="st">"AB UHB"</span>,</span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Cardiff &amp; Vale"</span> <span class="sc">~</span> <span class="st">"CAV UHB"</span>,</span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Abertawe Bro Morgannwg"</span> <span class="sc">~</span> <span class="st">"ABM"</span>,</span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Powys Teaching"</span> <span class="sc">~</span> <span class="st">"PT HB"</span>,</span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Betsi Cadwaladr"</span> <span class="sc">~</span> <span class="st">"BC UHB"</span>,</span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Cwm Taf"</span> <span class="sc">~</span> <span class="st">"Cwm Taf"</span>,</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Hywel Dda"</span> <span class="sc">~</span> <span class="st">"HD UHB"</span>,</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Cwm Taf Morgannwg"</span> <span class="sc">~</span> <span class="st">"CTM UHB"</span>,</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a>      Organisation <span class="sc">==</span> <span class="st">"Swansea Bay"</span> <span class="sc">~</span> <span class="st">"SB UHB"</span></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by_at</span>(<span class="fu">vars</span>(<span class="sc">-</span>Attendances)) <span class="sc">|&gt;</span></span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances)) <span class="sc">|&gt;</span></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(HLTH0037_data_v3, <span class="st">"data/HLTH0037_data_v3.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## import cleaned data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_v3 <span class="ot">&lt;-</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  readr<span class="sc">::</span><span class="fu">read_rds</span>(<span class="st">"data/HLTH0037_data_v3.rds"</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(HLTH0037_data_v3) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">gt</span>() <span class="sc">|&gt;</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_options</span>(<span class="at">table.font.size =</span> <span class="dv">12</span>) <span class="sc">|&gt;</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  gt<span class="sc">::</span><span class="fu">tab_style</span>(</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">style =</span>  gt<span class="sc">::</span><span class="fu">cell_text</span>(<span class="at">weight =</span> <span class="st">"bold"</span>),</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">locations =</span>  gt<span class="sc">::</span><span class="fu">cells_column_labels</span>()</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>        ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="kbmgxqojnc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#kbmgxqojnc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#kbmgxqojnc thead, #kbmgxqojnc tbody, #kbmgxqojnc tfoot, #kbmgxqojnc tr, #kbmgxqojnc td, #kbmgxqojnc th {
  border-style: none;
}

#kbmgxqojnc p {
  margin: 0;
  padding: 0;
}

#kbmgxqojnc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 12px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#kbmgxqojnc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#kbmgxqojnc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#kbmgxqojnc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#kbmgxqojnc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kbmgxqojnc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbmgxqojnc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#kbmgxqojnc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#kbmgxqojnc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#kbmgxqojnc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#kbmgxqojnc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#kbmgxqojnc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#kbmgxqojnc .gt_spanner_row {
  border-bottom-style: hidden;
}

#kbmgxqojnc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#kbmgxqojnc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#kbmgxqojnc .gt_from_md > :first-child {
  margin-top: 0;
}

#kbmgxqojnc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#kbmgxqojnc .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#kbmgxqojnc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#kbmgxqojnc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#kbmgxqojnc .gt_row_group_first td {
  border-top-width: 2px;
}

#kbmgxqojnc .gt_row_group_first th {
  border-top-width: 2px;
}

#kbmgxqojnc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbmgxqojnc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#kbmgxqojnc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#kbmgxqojnc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbmgxqojnc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbmgxqojnc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#kbmgxqojnc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#kbmgxqojnc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#kbmgxqojnc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#kbmgxqojnc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kbmgxqojnc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbmgxqojnc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#kbmgxqojnc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#kbmgxqojnc .gt_left {
  text-align: left;
}

#kbmgxqojnc .gt_center {
  text-align: center;
}

#kbmgxqojnc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#kbmgxqojnc .gt_font_normal {
  font-weight: normal;
}

#kbmgxqojnc .gt_font_bold {
  font-weight: bold;
}

#kbmgxqojnc .gt_font_italic {
  font-style: italic;
}

#kbmgxqojnc .gt_super {
  font-size: 65%;
}

#kbmgxqojnc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#kbmgxqojnc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#kbmgxqojnc .gt_indent_1 {
  text-indent: 5px;
}

#kbmgxqojnc .gt_indent_2 {
  text-indent: 10px;
}

#kbmgxqojnc .gt_indent_3 {
  text-indent: 15px;
}

#kbmgxqojnc .gt_indent_4 {
  text-indent: 20px;
}

#kbmgxqojnc .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="MonthYear">MonthYear</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Hospital">Hospital</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="LHB_code">LHB_code</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Age_band">Age_band</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Sex">Sex</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Organisation">Organisation</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="LHB">LHB</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" style="font-weight: bold;" scope="col" id="Attendances">Attendances</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="MonthYear" class="gt_row gt_center">2016 Apr</td>
<td headers="Hospital" class="gt_row gt_left">Breconshire War Memorial Hospital</td>
<td headers="LHB_code" class="gt_row gt_left">W11000024</td>
<td headers="Age_band" class="gt_row gt_right">0-17</td>
<td headers="Sex" class="gt_row gt_left">Female</td>
<td headers="Organisation" class="gt_row gt_left">Powys Teaching</td>
<td headers="LHB" class="gt_row gt_left">PT HB</td>
<td headers="Attendances" class="gt_row gt_right">81</td></tr>
    <tr><td headers="MonthYear" class="gt_row gt_center">2016 Apr</td>
<td headers="Hospital" class="gt_row gt_left">Breconshire War Memorial Hospital</td>
<td headers="LHB_code" class="gt_row gt_left">W11000024</td>
<td headers="Age_band" class="gt_row gt_right">0-17</td>
<td headers="Sex" class="gt_row gt_left">Male</td>
<td headers="Organisation" class="gt_row gt_left">Powys Teaching</td>
<td headers="LHB" class="gt_row gt_left">PT HB</td>
<td headers="Attendances" class="gt_row gt_right">70</td></tr>
    <tr><td headers="MonthYear" class="gt_row gt_center">2016 Apr</td>
<td headers="Hospital" class="gt_row gt_left">Breconshire War Memorial Hospital</td>
<td headers="LHB_code" class="gt_row gt_left">W11000024</td>
<td headers="Age_band" class="gt_row gt_right">18-69</td>
<td headers="Sex" class="gt_row gt_left">Female</td>
<td headers="Organisation" class="gt_row gt_left">Powys Teaching</td>
<td headers="LHB" class="gt_row gt_left">PT HB</td>
<td headers="Attendances" class="gt_row gt_right">142</td></tr>
    <tr><td headers="MonthYear" class="gt_row gt_center">2016 Apr</td>
<td headers="Hospital" class="gt_row gt_left">Breconshire War Memorial Hospital</td>
<td headers="LHB_code" class="gt_row gt_left">W11000024</td>
<td headers="Age_band" class="gt_row gt_right">18-69</td>
<td headers="Sex" class="gt_row gt_left">Male</td>
<td headers="Organisation" class="gt_row gt_left">Powys Teaching</td>
<td headers="LHB" class="gt_row gt_left">PT HB</td>
<td headers="Attendances" class="gt_row gt_right">154</td></tr>
    <tr><td headers="MonthYear" class="gt_row gt_center">2016 Apr</td>
<td headers="Hospital" class="gt_row gt_left">Breconshire War Memorial Hospital</td>
<td headers="LHB_code" class="gt_row gt_left">W11000024</td>
<td headers="Age_band" class="gt_row gt_right">70+</td>
<td headers="Sex" class="gt_row gt_left">Female</td>
<td headers="Organisation" class="gt_row gt_left">Powys Teaching</td>
<td headers="LHB" class="gt_row gt_left">PT HB</td>
<td headers="Attendances" class="gt_row gt_right">33</td></tr>
    <tr><td headers="MonthYear" class="gt_row gt_center">2016 Apr</td>
<td headers="Hospital" class="gt_row gt_left">Breconshire War Memorial Hospital</td>
<td headers="LHB_code" class="gt_row gt_left">W11000024</td>
<td headers="Age_band" class="gt_row gt_right">70+</td>
<td headers="Sex" class="gt_row gt_left">Male</td>
<td headers="Organisation" class="gt_row gt_left">Powys Teaching</td>
<td headers="LHB" class="gt_row gt_left">PT HB</td>
<td headers="Attendances" class="gt_row gt_right">34</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</section>
<section id="conversion-into-a-tsibble" class="level2">
<h2 class="anchored" data-anchor-id="conversion-into-a-tsibble">4. Conversion into a <code>tsibble</code></h2>
<p>Converting the dataframe into <code>tsibble</code> format</p>
<p>note: <code>index</code> must be in a date-type format (converted from character variable in raw data to MonthYear using <code>tsibble::yearmonth()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_ts <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_v3 <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  tsibble<span class="sc">::</span><span class="fu">as_tsibble</span>(</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="do">## index = time column in the table</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">index =</span> MonthYear, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">key =</span> <span class="fu">c</span>(Hospital,Sex,Age_band, LHB)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 18,854 x 8 [1M]
# Key:       Hospital, Sex, Age_band, LHB [418]
   MonthYear Hospital                LHB_c…¹ Age_b…² Sex   Organ…³ LHB   Atten…⁴
       &lt;mth&gt; &lt;chr&gt;                   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;int&gt;
 1  2016 Apr Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      81
 2  2016 May Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      67
 3  2016 Jun Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      62
 4  2016 Jul Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      66
 5  2016 Aug Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      56
 6  2016 Sep Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      71
 7  2016 Oct Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      56
 8  2016 Nov Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      53
 9  2016 Dec Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      38
10  2017 Jan Breconshire War Memori… W11000… 0-17    Fema… Powys … PT HB      42
# … with 18,844 more rows, and abbreviated variable names ¹​LHB_code, ²​Age_band,
#   ³​Organisation, ⁴​Attendances</code></pre>
</div>
</div>
<p>A tsibble with:</p>
<ul>
<li>18,525 rows x 8 columns</li>
<li>time resolution [1M] = Monthly data points</li>
<li>4 keys (=grouping variables) (411 combinations/time series)</li>
</ul>
</section>
<section id="time-series-plotting" class="level2">
<h2 class="anchored" data-anchor-id="time-series-plotting">5. Time series plotting</h2>
<section id="time-lines" class="level3">
<h3 class="anchored" data-anchor-id="time-lines">5.1 Time lines</h3>
<p>Use function <code>fabletools::autoplot()</code></p>
<p>All Wales aggregated data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>AllWales_ts<span class="ot">&lt;-</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_ts <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>AllWales_ts</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 91 x 2 [1M]
   MonthYear Attendances
       &lt;mth&gt;       &lt;int&gt;
 1  2016 Apr       79246
 2  2016 May       88058
 3  2016 Jun       84269
 4  2016 Jul       87252
 5  2016 Aug       85104
 6  2016 Sep       84134
 7  2016 Oct       85177
 8  2016 Nov       78154
 9  2016 Dec       76731
10  2017 Jan       77117
# … with 81 more rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances) <span class="sc">+</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"All Wales ED Attendances"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Data aggregated by keys</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="do">## by LHB</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>ByLHB_ts <span class="ot">&lt;-</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_ts <span class="sc">|&gt;</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(LHB) <span class="sc">|&gt;</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances)) </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ByLHB_ts <span class="sc">|&gt;</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances) <span class="sc">+</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ED Attendances by LHB"</span>) <span class="sc">+</span> </span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## by Age group</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>ByAge_ts <span class="ot">&lt;-</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_ts <span class="sc">|&gt;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Age_band) <span class="sc">|&gt;</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances)) </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>ByAge_ts <span class="sc">|&gt;</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances)<span class="sc">+</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  ggplot2<span class="sc">::</span><span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ED Attendances by Age Band"</span>) <span class="sc">+</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="do">## by Sex</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>BySex_ts <span class="ot">&lt;-</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  HLTH0037_data_ts <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Sex) <span class="sc">|&gt;</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>BySex_ts <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances)<span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ED Attendances by Sex"</span>) <span class="sc">+</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_ts <span class="sc">|&gt;</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Organisation <span class="sc">==</span> <span class="st">"Powys Teaching"</span>) <span class="sc">|&gt;</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Hospital) <span class="sc">|&gt;</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances)) <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances) <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ED Attendances by Hospital (PT HB)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>HLTH0037_data_ts <span class="sc">|&gt;</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(Organisation <span class="sc">==</span> <span class="st">"Powys Teaching"</span>) <span class="sc">|&gt;</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(Hospital) <span class="sc">|&gt;</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Attendances =</span> <span class="fu">sum</span>(Attendances)) <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ED Attendances by Hospital (PT HB)"</span>) <span class="sc">+</span> </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(Hospital), <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="interactive-time-lines" class="level3">
<h3 class="anchored" data-anchor-id="interactive-time-lines">5.2 Interactive Time lines</h3>
<section id="ggplotly" class="level4">
<h4 class="anchored" data-anchor-id="ggplotly"><strong>ggplotly</strong></h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>plotly<span class="sc">::</span><span class="fu">ggplotly</span>(ByLHB_ts <span class="sc">|&gt;</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> Attendances) <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"ED Attendances by LHB"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b5961719e05144435990" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b5961719e05144435990">{"x":{"data":[{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956],"y":[10451,11499,11028,11001,10656,11094,11332,10806,10372,10741,9395,11305,11049,11578,11175,11821,11113,11140,11660,11054,10893,11049,10286,10751,10949,11821,11810,12413,10866,10967,11814,11210,10750,11180,10361,11493],"text":["MonthYear: 2016 Apr<br />Attendances: 10451<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 May<br />Attendances: 11499<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Jun<br />Attendances: 11028<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Jul<br />Attendances: 11001<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Aug<br />Attendances: 10656<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Sep<br />Attendances: 11094<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Oct<br />Attendances: 11332<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Nov<br />Attendances: 10806<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2016 Dec<br />Attendances: 10372<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Jan<br />Attendances: 10741<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Feb<br />Attendances:  9395<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Mar<br />Attendances: 11305<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Apr<br />Attendances: 11049<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 May<br />Attendances: 11578<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Jun<br />Attendances: 11175<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Jul<br />Attendances: 11821<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Aug<br />Attendances: 11113<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Sep<br />Attendances: 11140<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Oct<br />Attendances: 11660<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Nov<br />Attendances: 11054<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2017 Dec<br />Attendances: 10893<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Jan<br />Attendances: 11049<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Feb<br />Attendances: 10286<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Mar<br />Attendances: 10751<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Apr<br />Attendances: 10949<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 May<br />Attendances: 11821<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Jun<br />Attendances: 11810<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Jul<br />Attendances: 12413<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Aug<br />Attendances: 10866<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Sep<br />Attendances: 10967<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Oct<br />Attendances: 11814<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Nov<br />Attendances: 11210<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2018 Dec<br />Attendances: 10750<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2019 Jan<br />Attendances: 11180<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2019 Feb<br />Attendances: 10361<br />interaction(LHB, sep = \"/\"): Cwm Taf","MonthYear: 2019 Mar<br />Attendances: 11493<br />interaction(LHB, sep = \"/\"): Cwm Taf"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,185,227,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[11080,12211,11693,11829,11078,11897,12175,11583,11033,11537,10447,12196,11669,12511,11988,12587,11459,12056,12995,11964,11684,11397,11145,11790,11772,12922,12617,12894,11867,12077,13148,12373,12045,12300,11615,13050,12631,13180,12587,13551,12078,13143,13752,13103,12528,12499,11846,8981,6099,8370,9467,10100,10340,10145,9363,9415,8298,7558,7445,9725,10886,11608,11892,11862,11243,11665,11809,11214,10237,10473,10362,12501,11096,12497,11941,11970,11838,12095,13069,12224,12702,11217,10996,12631,11750,13442,13157,12513,11706,12425,11718],"text":["MonthYear: 2016 Apr<br />Attendances: 11080<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 May<br />Attendances: 12211<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Jun<br />Attendances: 11693<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Jul<br />Attendances: 11829<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Aug<br />Attendances: 11078<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Sep<br />Attendances: 11897<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Oct<br />Attendances: 12175<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Nov<br />Attendances: 11583<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2016 Dec<br />Attendances: 11033<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Jan<br />Attendances: 11537<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Feb<br />Attendances: 10447<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Mar<br />Attendances: 12196<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Apr<br />Attendances: 11669<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 May<br />Attendances: 12511<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Jun<br />Attendances: 11988<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Jul<br />Attendances: 12587<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Aug<br />Attendances: 11459<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Sep<br />Attendances: 12056<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Oct<br />Attendances: 12995<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Nov<br />Attendances: 11964<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2017 Dec<br />Attendances: 11684<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Jan<br />Attendances: 11397<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Feb<br />Attendances: 11145<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Mar<br />Attendances: 11790<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Apr<br />Attendances: 11772<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 May<br />Attendances: 12922<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Jun<br />Attendances: 12617<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Jul<br />Attendances: 12894<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Aug<br />Attendances: 11867<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Sep<br />Attendances: 12077<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Oct<br />Attendances: 13148<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Nov<br />Attendances: 12373<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2018 Dec<br />Attendances: 12045<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Jan<br />Attendances: 12300<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Feb<br />Attendances: 11615<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Mar<br />Attendances: 13050<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Apr<br />Attendances: 12631<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 May<br />Attendances: 13180<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Jun<br />Attendances: 12587<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Jul<br />Attendances: 13551<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Aug<br />Attendances: 12078<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Sep<br />Attendances: 13143<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Oct<br />Attendances: 13752<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Nov<br />Attendances: 13103<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2019 Dec<br />Attendances: 12528<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Jan<br />Attendances: 12499<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Feb<br />Attendances: 11846<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Mar<br />Attendances:  8981<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Apr<br />Attendances:  6099<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 May<br />Attendances:  8370<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Jun<br />Attendances:  9467<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Jul<br />Attendances: 10100<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Aug<br />Attendances: 10340<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Sep<br />Attendances: 10145<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Oct<br />Attendances:  9363<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Nov<br />Attendances:  9415<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2020 Dec<br />Attendances:  8298<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Jan<br />Attendances:  7558<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Feb<br />Attendances:  7445<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Mar<br />Attendances:  9725<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Apr<br />Attendances: 10886<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 May<br />Attendances: 11608<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Jun<br />Attendances: 11892<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Jul<br />Attendances: 11862<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Aug<br />Attendances: 11243<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Sep<br />Attendances: 11665<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Oct<br />Attendances: 11809<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Nov<br />Attendances: 11214<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2021 Dec<br />Attendances: 10237<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Jan<br />Attendances: 10473<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Feb<br />Attendances: 10362<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Mar<br />Attendances: 12501<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Apr<br />Attendances: 11096<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 May<br />Attendances: 12497<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Jun<br />Attendances: 11941<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Jul<br />Attendances: 11970<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Aug<br />Attendances: 11838<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Sep<br />Attendances: 12095<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Oct<br />Attendances: 13069<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Nov<br />Attendances: 12224<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2022 Dec<br />Attendances: 12702<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Jan<br />Attendances: 11217<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Feb<br />Attendances: 10996<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Mar<br />Attendances: 12631<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Apr<br />Attendances: 11750<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 May<br />Attendances: 13442<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Jun<br />Attendances: 13157<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Jul<br />Attendances: 12513<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Aug<br />Attendances: 11706<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Sep<br />Attendances: 12425<br />interaction(LHB, sep = \"/\"): CAV UHB","MonthYear: 2023 Oct<br />Attendances: 11718<br />interaction(LHB, sep = \"/\"): CAV UHB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,186,56,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[16647,16681,15863,17679,16110,16746,16747,15896,15668,15526,13999,11477,8078,11593,12791,14150,14856,13716,11241,11383,11016,10197,10383,13770,15526,16154,17169,16722,15679,15650,15353,14258,13464,13788,13135,15672,14289,15441,15149,15553,14858,14716,15830,15226,15829,13883,13723,15844,15503,17531,16674,16794,16064,16127,16643],"text":["MonthYear: 2019 Apr<br />Attendances: 16647<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 May<br />Attendances: 16681<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Jun<br />Attendances: 15863<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Jul<br />Attendances: 17679<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Aug<br />Attendances: 16110<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Sep<br />Attendances: 16746<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Oct<br />Attendances: 16747<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Nov<br />Attendances: 15896<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2019 Dec<br />Attendances: 15668<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Jan<br />Attendances: 15526<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Feb<br />Attendances: 13999<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Mar<br />Attendances: 11477<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Apr<br />Attendances:  8078<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 May<br />Attendances: 11593<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Jun<br />Attendances: 12791<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Jul<br />Attendances: 14150<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Aug<br />Attendances: 14856<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Sep<br />Attendances: 13716<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Oct<br />Attendances: 11241<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Nov<br />Attendances: 11383<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2020 Dec<br />Attendances: 11016<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Jan<br />Attendances: 10197<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Feb<br />Attendances: 10383<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Mar<br />Attendances: 13770<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Apr<br />Attendances: 15526<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 May<br />Attendances: 16154<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Jun<br />Attendances: 17169<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Jul<br />Attendances: 16722<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Aug<br />Attendances: 15679<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Sep<br />Attendances: 15650<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Oct<br />Attendances: 15353<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Nov<br />Attendances: 14258<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2021 Dec<br />Attendances: 13464<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Jan<br />Attendances: 13788<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Feb<br />Attendances: 13135<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Mar<br />Attendances: 15672<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Apr<br />Attendances: 14289<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 May<br />Attendances: 15441<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Jun<br />Attendances: 15149<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Jul<br />Attendances: 15553<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Aug<br />Attendances: 14858<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Sep<br />Attendances: 14716<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Oct<br />Attendances: 15830<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Nov<br />Attendances: 15226<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2022 Dec<br />Attendances: 15829<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Jan<br />Attendances: 13883<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Feb<br />Attendances: 13723<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Mar<br />Attendances: 15844<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Apr<br />Attendances: 15503<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 May<br />Attendances: 17531<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Jun<br />Attendances: 16674<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Jul<br />Attendances: 16794<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Aug<br />Attendances: 16064<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Sep<br />Attendances: 16127<br />interaction(LHB, sep = \"/\"): CTM UHB","MonthYear: 2023 Oct<br />Attendances: 16643<br />interaction(LHB, sep = \"/\"): CTM UHB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(0,193,159,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[11566,13004,12033,12718,12609,11980,12251,10934,11002,11026,10329,12184,12169,13118,12473,13850,14146,12903,13444,12264,12731,12057,11239,12877,12900,14603,14049,15135,14377,13187,13291,12097,12289,12808,11908,13686,13708,14178,13127,15058,14732,13802,13309,12762,12407,12236,11341,9360,6044,8592,9533,11211,12810,11524,9874,9366,8298,7823,7974,10973,12631,13283,14490,15085,14601,13018,12742,12044,11352,11368,11011,13609,13477,14369,14029,14688,15097,13578,14281,13160,13815,12114,12027,13895,13917,15633,15526,15264,15473,14571,14750],"text":["MonthYear: 2016 Apr<br />Attendances: 11566<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 May<br />Attendances: 13004<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Jun<br />Attendances: 12033<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Jul<br />Attendances: 12718<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Aug<br />Attendances: 12609<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Sep<br />Attendances: 11980<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Oct<br />Attendances: 12251<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Nov<br />Attendances: 10934<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2016 Dec<br />Attendances: 11002<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Jan<br />Attendances: 11026<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Feb<br />Attendances: 10329<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Mar<br />Attendances: 12184<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Apr<br />Attendances: 12169<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 May<br />Attendances: 13118<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Jun<br />Attendances: 12473<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Jul<br />Attendances: 13850<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Aug<br />Attendances: 14146<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Sep<br />Attendances: 12903<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Oct<br />Attendances: 13444<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Nov<br />Attendances: 12264<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2017 Dec<br />Attendances: 12731<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Jan<br />Attendances: 12057<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Feb<br />Attendances: 11239<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Mar<br />Attendances: 12877<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Apr<br />Attendances: 12900<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 May<br />Attendances: 14603<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Jun<br />Attendances: 14049<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Jul<br />Attendances: 15135<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Aug<br />Attendances: 14377<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Sep<br />Attendances: 13187<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Oct<br />Attendances: 13291<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Nov<br />Attendances: 12097<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2018 Dec<br />Attendances: 12289<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Jan<br />Attendances: 12808<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Feb<br />Attendances: 11908<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Mar<br />Attendances: 13686<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Apr<br />Attendances: 13708<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 May<br />Attendances: 14178<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Jun<br />Attendances: 13127<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Jul<br />Attendances: 15058<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Aug<br />Attendances: 14732<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Sep<br />Attendances: 13802<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Oct<br />Attendances: 13309<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Nov<br />Attendances: 12762<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2019 Dec<br />Attendances: 12407<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Jan<br />Attendances: 12236<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Feb<br />Attendances: 11341<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Mar<br />Attendances:  9360<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Apr<br />Attendances:  6044<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 May<br />Attendances:  8592<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Jun<br />Attendances:  9533<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Jul<br />Attendances: 11211<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Aug<br />Attendances: 12810<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Sep<br />Attendances: 11524<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Oct<br />Attendances:  9874<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Nov<br />Attendances:  9366<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2020 Dec<br />Attendances:  8298<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Jan<br />Attendances:  7823<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Feb<br />Attendances:  7974<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Mar<br />Attendances: 10973<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Apr<br />Attendances: 12631<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 May<br />Attendances: 13283<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Jun<br />Attendances: 14490<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Jul<br />Attendances: 15085<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Aug<br />Attendances: 14601<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Sep<br />Attendances: 13018<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Oct<br />Attendances: 12742<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Nov<br />Attendances: 12044<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2021 Dec<br />Attendances: 11352<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Jan<br />Attendances: 11368<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Feb<br />Attendances: 11011<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Mar<br />Attendances: 13609<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Apr<br />Attendances: 13477<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 May<br />Attendances: 14369<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Jun<br />Attendances: 14029<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Jul<br />Attendances: 14688<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Aug<br />Attendances: 15097<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Sep<br />Attendances: 13578<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Oct<br />Attendances: 14281<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Nov<br />Attendances: 13160<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2022 Dec<br />Attendances: 13815<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Jan<br />Attendances: 12114<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Feb<br />Attendances: 12027<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Mar<br />Attendances: 13895<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Apr<br />Attendances: 13917<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 May<br />Attendances: 15633<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Jun<br />Attendances: 15526<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Jul<br />Attendances: 15264<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Aug<br />Attendances: 15473<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Sep<br />Attendances: 14571<br />interaction(LHB, sep = \"/\"): HD UHB","MonthYear: 2023 Oct<br />Attendances: 14750<br />interaction(LHB, sep = \"/\"): HD UHB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(97,156,255,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[16284,18230,17665,18947,19606,17814,17421,15555,15619,15323,14408,16901,17528,18922,17812,19120,19674,17100,18011,16077,16293,15739,14758,16656,17422,19193,18990,20140,19252,16974,17580,16197,16457,16501,15684,17271,18085,18935,18304,20506,20543,18111,17786,16714,17314,16543,15760,13097,8586,11624,13143,14518,16183,15358,13464,12897,12498,11756,11396,14013,16390,17849,18745,19340,18534,17523,17019,16216,15082,15245,14941,17831,17265,18750,18270,20240,20810,19247,20025,18761,19171,17148,16981,19535,19499,22242,22706,22008,22178,21165,21188],"text":["MonthYear: 2016 Apr<br />Attendances: 16284<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 May<br />Attendances: 18230<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Jun<br />Attendances: 17665<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Jul<br />Attendances: 18947<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Aug<br />Attendances: 19606<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Sep<br />Attendances: 17814<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Oct<br />Attendances: 17421<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Nov<br />Attendances: 15555<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2016 Dec<br />Attendances: 15619<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Jan<br />Attendances: 15323<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Feb<br />Attendances: 14408<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Mar<br />Attendances: 16901<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Apr<br />Attendances: 17528<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 May<br />Attendances: 18922<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Jun<br />Attendances: 17812<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Jul<br />Attendances: 19120<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Aug<br />Attendances: 19674<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Sep<br />Attendances: 17100<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Oct<br />Attendances: 18011<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Nov<br />Attendances: 16077<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2017 Dec<br />Attendances: 16293<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Jan<br />Attendances: 15739<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Feb<br />Attendances: 14758<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Mar<br />Attendances: 16656<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Apr<br />Attendances: 17422<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 May<br />Attendances: 19193<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Jun<br />Attendances: 18990<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Jul<br />Attendances: 20140<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Aug<br />Attendances: 19252<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Sep<br />Attendances: 16974<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Oct<br />Attendances: 17580<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Nov<br />Attendances: 16197<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2018 Dec<br />Attendances: 16457<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Jan<br />Attendances: 16501<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Feb<br />Attendances: 15684<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Mar<br />Attendances: 17271<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Apr<br />Attendances: 18085<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 May<br />Attendances: 18935<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Jun<br />Attendances: 18304<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Jul<br />Attendances: 20506<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Aug<br />Attendances: 20543<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Sep<br />Attendances: 18111<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Oct<br />Attendances: 17786<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Nov<br />Attendances: 16714<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2019 Dec<br />Attendances: 17314<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Jan<br />Attendances: 16543<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Feb<br />Attendances: 15760<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Mar<br />Attendances: 13097<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Apr<br />Attendances:  8586<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 May<br />Attendances: 11624<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Jun<br />Attendances: 13143<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Jul<br />Attendances: 14518<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Aug<br />Attendances: 16183<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Sep<br />Attendances: 15358<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Oct<br />Attendances: 13464<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Nov<br />Attendances: 12897<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2020 Dec<br />Attendances: 12498<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Jan<br />Attendances: 11756<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Feb<br />Attendances: 11396<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Mar<br />Attendances: 14013<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Apr<br />Attendances: 16390<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 May<br />Attendances: 17849<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Jun<br />Attendances: 18745<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Jul<br />Attendances: 19340<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Aug<br />Attendances: 18534<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Sep<br />Attendances: 17523<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Oct<br />Attendances: 17019<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Nov<br />Attendances: 16216<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2021 Dec<br />Attendances: 15082<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Jan<br />Attendances: 15245<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Feb<br />Attendances: 14941<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Mar<br />Attendances: 17831<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Apr<br />Attendances: 17265<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 May<br />Attendances: 18750<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Jun<br />Attendances: 18270<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Jul<br />Attendances: 20240<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Aug<br />Attendances: 20810<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Sep<br />Attendances: 19247<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Oct<br />Attendances: 20025<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Nov<br />Attendances: 18761<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2022 Dec<br />Attendances: 19171<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Jan<br />Attendances: 17148<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Feb<br />Attendances: 16981<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Mar<br />Attendances: 19535<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Apr<br />Attendances: 19499<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 May<br />Attendances: 22242<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Jun<br />Attendances: 22706<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Jul<br />Attendances: 22008<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Aug<br />Attendances: 22178<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Sep<br />Attendances: 21165<br />interaction(LHB, sep = \"/\"): BC UHB","MonthYear: 2023 Oct<br />Attendances: 21188<br />interaction(LHB, sep = \"/\"): BC UHB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(147,170,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956],"y":[15153,16725,15862,16125,15850,15826,16536,14904,14816,14430,13456,15816,15653,16759,15736,16431,16017,15571,16301,15108,15055,14515,13487,15098,15163,16935,16217,16548,15005,14928,15449,14106,13999,14414,13611,15438],"text":["MonthYear: 2016 Apr<br />Attendances: 15153<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 May<br />Attendances: 16725<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Jun<br />Attendances: 15862<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Jul<br />Attendances: 16125<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Aug<br />Attendances: 15850<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Sep<br />Attendances: 15826<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Oct<br />Attendances: 16536<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Nov<br />Attendances: 14904<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2016 Dec<br />Attendances: 14816<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Jan<br />Attendances: 14430<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Feb<br />Attendances: 13456<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Mar<br />Attendances: 15816<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Apr<br />Attendances: 15653<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 May<br />Attendances: 16759<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Jun<br />Attendances: 15736<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Jul<br />Attendances: 16431<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Aug<br />Attendances: 16017<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Sep<br />Attendances: 15571<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Oct<br />Attendances: 16301<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Nov<br />Attendances: 15108<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2017 Dec<br />Attendances: 15055<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Jan<br />Attendances: 14515<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Feb<br />Attendances: 13487<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Mar<br />Attendances: 15098<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Apr<br />Attendances: 15163<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 May<br />Attendances: 16935<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Jun<br />Attendances: 16217<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Jul<br />Attendances: 16548<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Aug<br />Attendances: 15005<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Sep<br />Attendances: 14928<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Oct<br />Attendances: 15449<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Nov<br />Attendances: 14106<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2018 Dec<br />Attendances: 13999<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2019 Jan<br />Attendances: 14414<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2019 Feb<br />Attendances: 13611<br />interaction(LHB, sep = \"/\"): ABM","MonthYear: 2019 Mar<br />Attendances: 15438<br />interaction(LHB, sep = \"/\"): ABM"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(211,146,0,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[1567,1697,1706,1801,1711,1619,1507,1426,1337,1321,1341,1544,1648,1840,1759,1846,1807,1633,1624,1427,1315,1405,1374,1419,1536,1888,2058,1993,1701,1593,1644,1445,1438,1362,1411,1581,1626,1795,1656,2078,1749,1799,1541,1389,1370,1391,1328,982,531,717,829,911,930,921,714,757,595,478,588,794,943,947,1285,1384,1115,1146,1027,974,836,879,829,1137,1166,1272,1304,1365,1369,1167,1191,1052,913,978,1078,1134,1061,1298,1547,1325,1288,1330,1201],"text":["MonthYear: 2016 Apr<br />Attendances:  1567<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 May<br />Attendances:  1697<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Jun<br />Attendances:  1706<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Jul<br />Attendances:  1801<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Aug<br />Attendances:  1711<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Sep<br />Attendances:  1619<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Oct<br />Attendances:  1507<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Nov<br />Attendances:  1426<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2016 Dec<br />Attendances:  1337<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Jan<br />Attendances:  1321<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Feb<br />Attendances:  1341<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Mar<br />Attendances:  1544<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Apr<br />Attendances:  1648<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 May<br />Attendances:  1840<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Jun<br />Attendances:  1759<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Jul<br />Attendances:  1846<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Aug<br />Attendances:  1807<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Sep<br />Attendances:  1633<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Oct<br />Attendances:  1624<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Nov<br />Attendances:  1427<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2017 Dec<br />Attendances:  1315<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Jan<br />Attendances:  1405<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Feb<br />Attendances:  1374<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Mar<br />Attendances:  1419<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Apr<br />Attendances:  1536<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 May<br />Attendances:  1888<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Jun<br />Attendances:  2058<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Jul<br />Attendances:  1993<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Aug<br />Attendances:  1701<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Sep<br />Attendances:  1593<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Oct<br />Attendances:  1644<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Nov<br />Attendances:  1445<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2018 Dec<br />Attendances:  1438<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Jan<br />Attendances:  1362<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Feb<br />Attendances:  1411<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Mar<br />Attendances:  1581<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Apr<br />Attendances:  1626<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 May<br />Attendances:  1795<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Jun<br />Attendances:  1656<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Jul<br />Attendances:  2078<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Aug<br />Attendances:  1749<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Sep<br />Attendances:  1799<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Oct<br />Attendances:  1541<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Nov<br />Attendances:  1389<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2019 Dec<br />Attendances:  1370<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Jan<br />Attendances:  1391<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Feb<br />Attendances:  1328<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Mar<br />Attendances:   982<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Apr<br />Attendances:   531<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 May<br />Attendances:   717<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Jun<br />Attendances:   829<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Jul<br />Attendances:   911<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Aug<br />Attendances:   930<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Sep<br />Attendances:   921<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Oct<br />Attendances:   714<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Nov<br />Attendances:   757<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2020 Dec<br />Attendances:   595<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Jan<br />Attendances:   478<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Feb<br />Attendances:   588<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Mar<br />Attendances:   794<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Apr<br />Attendances:   943<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 May<br />Attendances:   947<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Jun<br />Attendances:  1285<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Jul<br />Attendances:  1384<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Aug<br />Attendances:  1115<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Sep<br />Attendances:  1146<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Oct<br />Attendances:  1027<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Nov<br />Attendances:   974<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2021 Dec<br />Attendances:   836<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Jan<br />Attendances:   879<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Feb<br />Attendances:   829<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Mar<br />Attendances:  1137<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Apr<br />Attendances:  1166<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 May<br />Attendances:  1272<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Jun<br />Attendances:  1304<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Jul<br />Attendances:  1365<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Aug<br />Attendances:  1369<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Sep<br />Attendances:  1167<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Oct<br />Attendances:  1191<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Nov<br />Attendances:  1052<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2022 Dec<br />Attendances:   913<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Jan<br />Attendances:   978<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Feb<br />Attendances:  1078<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Mar<br />Attendances:  1134<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Apr<br />Attendances:  1061<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 May<br />Attendances:  1298<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Jun<br />Attendances:  1547<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Jul<br />Attendances:  1325<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Aug<br />Attendances:  1288<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Sep<br />Attendances:  1330<br />interaction(LHB, sep = \"/\"): PT HB","MonthYear: 2023 Oct<br />Attendances:  1201<br />interaction(LHB, sep = \"/\"): PT HB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(219,114,251,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[16892,16922,16953,16983,17014,17045,17075,17106,17136,17167,17198,17226,17257,17287,17318,17348,17379,17410,17440,17471,17501,17532,17563,17591,17622,17652,17683,17713,17744,17775,17805,17836,17866,17897,17928,17956,17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[13145,14692,14282,14831,13594,13904,13955,12946,12552,12739,11719,14324,13992,14755,14278,14940,14017,14046,14549,13309,13086,13179,12160,13061,13504,14939,14796,15464,14133,13887,14159,13428,13401,13847,12847,14864,14651,15009,14475,16309,14475,14968,14658,14042,14526,13792,12838,10230,6894,10086,10971,12260,12956,12532,11015,11087,10166,9518,9170,12450,14300,14788,16584,16081,4939,15809,15196,14411,12749,12990,12951,15812,14015,16006,15946,16087,15456,15189,16007,14817,15666,13218,13318,15013,14825,16860,16683,15788,15191,15831,16195],"text":["MonthYear: 2016 Apr<br />Attendances: 13145<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 May<br />Attendances: 14692<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Jun<br />Attendances: 14282<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Jul<br />Attendances: 14831<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Aug<br />Attendances: 13594<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Sep<br />Attendances: 13904<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Oct<br />Attendances: 13955<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Nov<br />Attendances: 12946<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2016 Dec<br />Attendances: 12552<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Jan<br />Attendances: 12739<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Feb<br />Attendances: 11719<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Mar<br />Attendances: 14324<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Apr<br />Attendances: 13992<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 May<br />Attendances: 14755<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Jun<br />Attendances: 14278<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Jul<br />Attendances: 14940<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Aug<br />Attendances: 14017<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Sep<br />Attendances: 14046<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Oct<br />Attendances: 14549<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Nov<br />Attendances: 13309<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2017 Dec<br />Attendances: 13086<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Jan<br />Attendances: 13179<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Feb<br />Attendances: 12160<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Mar<br />Attendances: 13061<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Apr<br />Attendances: 13504<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 May<br />Attendances: 14939<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Jun<br />Attendances: 14796<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Jul<br />Attendances: 15464<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Aug<br />Attendances: 14133<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Sep<br />Attendances: 13887<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Oct<br />Attendances: 14159<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Nov<br />Attendances: 13428<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2018 Dec<br />Attendances: 13401<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Jan<br />Attendances: 13847<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Feb<br />Attendances: 12847<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Mar<br />Attendances: 14864<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Apr<br />Attendances: 14651<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 May<br />Attendances: 15009<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Jun<br />Attendances: 14475<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Jul<br />Attendances: 16309<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Aug<br />Attendances: 14475<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Sep<br />Attendances: 14968<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Oct<br />Attendances: 14658<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Nov<br />Attendances: 14042<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2019 Dec<br />Attendances: 14526<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Jan<br />Attendances: 13792<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Feb<br />Attendances: 12838<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Mar<br />Attendances: 10230<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Apr<br />Attendances:  6894<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 May<br />Attendances: 10086<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Jun<br />Attendances: 10971<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Jul<br />Attendances: 12260<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Aug<br />Attendances: 12956<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Sep<br />Attendances: 12532<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Oct<br />Attendances: 11015<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Nov<br />Attendances: 11087<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2020 Dec<br />Attendances: 10166<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Jan<br />Attendances:  9518<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Feb<br />Attendances:  9170<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Mar<br />Attendances: 12450<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Apr<br />Attendances: 14300<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 May<br />Attendances: 14788<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Jun<br />Attendances: 16584<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Jul<br />Attendances: 16081<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Aug<br />Attendances:  4939<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Sep<br />Attendances: 15809<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Oct<br />Attendances: 15196<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Nov<br />Attendances: 14411<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2021 Dec<br />Attendances: 12749<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Jan<br />Attendances: 12990<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Feb<br />Attendances: 12951<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Mar<br />Attendances: 15812<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Apr<br />Attendances: 14015<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 May<br />Attendances: 16006<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Jun<br />Attendances: 15946<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Jul<br />Attendances: 16087<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Aug<br />Attendances: 15456<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Sep<br />Attendances: 15189<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Oct<br />Attendances: 16007<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Nov<br />Attendances: 14817<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2022 Dec<br />Attendances: 15666<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Jan<br />Attendances: 13218<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Feb<br />Attendances: 13318<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Mar<br />Attendances: 15013<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Apr<br />Attendances: 14825<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 May<br />Attendances: 16860<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Jun<br />Attendances: 16683<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Jul<br />Attendances: 15788<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Aug<br />Attendances: 15191<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Sep<br />Attendances: 15831<br />interaction(LHB, sep = \"/\"): AB UHB","MonthYear: 2023 Oct<br />Attendances: 16195<br />interaction(LHB, sep = \"/\"): AB UHB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(248,118,109,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null},{"x":[17987,18017,18048,18078,18109,18140,18170,18201,18231,18262,18293,18322,18353,18383,18414,18444,18475,18506,18536,18567,18597,18628,18659,18687,18718,18748,18779,18809,18840,18871,18901,18932,18962,18993,19024,19052,19083,19113,19144,19174,19205,19236,19266,19297,19327,19358,19389,19417,19448,19478,19509,19539,19570,19601,19631],"y":[10728,10906,10334,11690,10795,10960,10841,10156,9815,9960,9142,7487,5270,7756,8534,9106,9672,9319,7909,7917,7015,6560,6653,8840,10354,10775,11584,11461,11036,11193,10743,10128,9113,9097,9270,11074,10758,11235,10654,10896,10737,10328,11032,9775,10189,9363,9699,11216,10569,12182,12044,11261,10930,11212,11598],"text":["MonthYear: 2019 Apr<br />Attendances: 10728<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 May<br />Attendances: 10906<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Jun<br />Attendances: 10334<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Jul<br />Attendances: 11690<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Aug<br />Attendances: 10795<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Sep<br />Attendances: 10960<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Oct<br />Attendances: 10841<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Nov<br />Attendances: 10156<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2019 Dec<br />Attendances:  9815<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Jan<br />Attendances:  9960<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Feb<br />Attendances:  9142<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Mar<br />Attendances:  7487<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Apr<br />Attendances:  5270<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 May<br />Attendances:  7756<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Jun<br />Attendances:  8534<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Jul<br />Attendances:  9106<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Aug<br />Attendances:  9672<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Sep<br />Attendances:  9319<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Oct<br />Attendances:  7909<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Nov<br />Attendances:  7917<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2020 Dec<br />Attendances:  7015<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Jan<br />Attendances:  6560<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Feb<br />Attendances:  6653<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Mar<br />Attendances:  8840<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Apr<br />Attendances: 10354<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 May<br />Attendances: 10775<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Jun<br />Attendances: 11584<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Jul<br />Attendances: 11461<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Aug<br />Attendances: 11036<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Sep<br />Attendances: 11193<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Oct<br />Attendances: 10743<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Nov<br />Attendances: 10128<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2021 Dec<br />Attendances:  9113<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Jan<br />Attendances:  9097<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Feb<br />Attendances:  9270<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Mar<br />Attendances: 11074<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Apr<br />Attendances: 10758<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 May<br />Attendances: 11235<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Jun<br />Attendances: 10654<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Jul<br />Attendances: 10896<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Aug<br />Attendances: 10737<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Sep<br />Attendances: 10328<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Oct<br />Attendances: 11032<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Nov<br />Attendances:  9775<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2022 Dec<br />Attendances: 10189<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Jan<br />Attendances:  9363<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Feb<br />Attendances:  9699<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Mar<br />Attendances: 11216<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Apr<br />Attendances: 10569<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 May<br />Attendances: 12182<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Jun<br />Attendances: 12044<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Jul<br />Attendances: 11261<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Aug<br />Attendances: 10930<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Sep<br />Attendances: 11212<br />interaction(LHB, sep = \"/\"): SB UHB","MonthYear: 2023 Oct<br />Attendances: 11598<br />interaction(LHB, sep = \"/\"): SB UHB"],"type":"scatter","mode":"lines","line":{"width":1.88976377952756,"color":"rgba(255,97,195,1)","dash":"solid"},"hoveron":"points","showlegend":false,"xaxis":"x","yaxis":"y","hoverinfo":"text","frame":null}],"layout":{"margin":{"t":43.7625570776256,"r":7.30593607305936,"b":40.1826484018265,"l":54.7945205479452},"plot_bgcolor":"rgba(235,235,235,1)","paper_bgcolor":"rgba(255,255,255,1)","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187},"title":{"text":"ED Attendances by LHB","font":{"color":"rgba(0,0,0,1)","family":"","size":17.5342465753425},"x":0,"xref":"paper"},"xaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[16755.05,19767.95],"tickmode":"array","ticktext":["2016 Jan","2018 Jan","2020 Jan","2022 Jan","2024 Jan"],"tickvals":[16801,17532,18262,18993,19723],"categoryorder":"array","categoryarray":["2016 Jan","2018 Jan","2020 Jan","2022 Jan","2024 Jan"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"y","title":{"text":"MonthYear [1M]","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"yaxis":{"domain":[0,1],"automargin":true,"type":"linear","autorange":false,"range":[-633.4,23817.4],"tickmode":"array","ticktext":["0","5000","10000","15000","20000"],"tickvals":[0,5000,10000,15000,20000],"categoryorder":"array","categoryarray":["0","5000","10000","15000","20000"],"nticks":null,"ticks":"outside","tickcolor":"rgba(51,51,51,1)","ticklen":3.65296803652968,"tickwidth":0.66417600664176,"showticklabels":true,"tickfont":{"color":"rgba(77,77,77,1)","family":"","size":11.689497716895},"tickangle":-0,"showline":false,"linecolor":null,"linewidth":0,"showgrid":true,"gridcolor":"rgba(255,255,255,1)","gridwidth":0.66417600664176,"zeroline":false,"anchor":"x","title":{"text":"Attendances","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}},"hoverformat":".2f"},"shapes":[{"type":"rect","fillcolor":null,"line":{"color":null,"width":0,"linetype":[]},"yref":"paper","xref":"paper","x0":0,"x1":1,"y0":0,"y1":1}],"showlegend":false,"legend":{"bgcolor":"rgba(255,255,255,1)","bordercolor":"transparent","borderwidth":1.88976377952756,"font":{"color":"rgba(0,0,0,1)","family":"","size":11.689497716895},"title":{"text":"LHB","font":{"color":"rgba(0,0,0,1)","family":"","size":14.6118721461187}}},"hovermode":"closest","barmode":"relative"},"config":{"doubleClick":"reset","modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"source":"A","attrs":{"6346f6639b3":{"x":{},"y":{},"colour":{},"type":"scatter"}},"cur_data":"6346f6639b3","visdat":{"6346f6639b3":["function (y) ","x"]},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="dygraphs" class="level4">
<h4 class="anchored" data-anchor-id="dygraphs"><strong>dygraphs</strong></h4>
<p><a href="https://rstudio.github.io/dygraphs/index.html" class="uri">https://rstudio.github.io/dygraphs/index.html</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dygraphs) <span class="co"># interactive time series</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xts) <span class="co"># create time series objects (class xs)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>dygraphs<span class="sc">::</span><span class="fu">dygraph</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  tsbox<span class="sc">::</span><span class="fu">ts_xts</span>(ByLHB_ts), <span class="do">## convert tsibble object into xts</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">main=</span><span class="st">'ED Attendances by LHB'</span>,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="st">"Monthly ED Attendances"</span>,</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="st">"Month Year"</span>)<span class="sc">|&gt;</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyRangeSelector</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-12e66176341375d9a90d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-12e66176341375d9a90d">{"x":{"attrs":{"title":"ED Attendances by LHB","xlabel":"Month Year","ylabel":"Monthly ED Attendances","labels":["month","AB UHB","ABM","BC UHB","CAV UHB","CTM UHB","Cwm Taf","HD UHB","PT HB","SB UHB"],"legend":"auto","retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60}},"showRangeSelector":true,"rangeSelectorHeight":40,"rangeSelectorPlotFillColor":" #A7B1C4","rangeSelectorPlotStrokeColor":"#808FAB","interactionModel":"Dygraph.Interaction.defaultModel"},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z"],[13145,14692,14282,14831,13594,13904,13955,12946,12552,12739,11719,14324,13992,14755,14278,14940,14017,14046,14549,13309,13086,13179,12160,13061,13504,14939,14796,15464,14133,13887,14159,13428,13401,13847,12847,14864,14651,15009,14475,16309,14475,14968,14658,14042,14526,13792,12838,10230,6894,10086,10971,12260,12956,12532,11015,11087,10166,9518,9170,12450,14300,14788,16584,16081,4939,15809,15196,14411,12749,12990,12951,15812,14015,16006,15946,16087,15456,15189,16007,14817,15666,13218,13318,15013,14825,16860,16683,15788,15191,15831,16195],[15153,16725,15862,16125,15850,15826,16536,14904,14816,14430,13456,15816,15653,16759,15736,16431,16017,15571,16301,15108,15055,14515,13487,15098,15163,16935,16217,16548,15005,14928,15449,14106,13999,14414,13611,15438,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[16284,18230,17665,18947,19606,17814,17421,15555,15619,15323,14408,16901,17528,18922,17812,19120,19674,17100,18011,16077,16293,15739,14758,16656,17422,19193,18990,20140,19252,16974,17580,16197,16457,16501,15684,17271,18085,18935,18304,20506,20543,18111,17786,16714,17314,16543,15760,13097,8586,11624,13143,14518,16183,15358,13464,12897,12498,11756,11396,14013,16390,17849,18745,19340,18534,17523,17019,16216,15082,15245,14941,17831,17265,18750,18270,20240,20810,19247,20025,18761,19171,17148,16981,19535,19499,22242,22706,22008,22178,21165,21188],[11080,12211,11693,11829,11078,11897,12175,11583,11033,11537,10447,12196,11669,12511,11988,12587,11459,12056,12995,11964,11684,11397,11145,11790,11772,12922,12617,12894,11867,12077,13148,12373,12045,12300,11615,13050,12631,13180,12587,13551,12078,13143,13752,13103,12528,12499,11846,8981,6099,8370,9467,10100,10340,10145,9363,9415,8298,7558,7445,9725,10886,11608,11892,11862,11243,11665,11809,11214,10237,10473,10362,12501,11096,12497,11941,11970,11838,12095,13069,12224,12702,11217,10996,12631,11750,13442,13157,12513,11706,12425,11718],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,16647,16681,15863,17679,16110,16746,16747,15896,15668,15526,13999,11477,8078,11593,12791,14150,14856,13716,11241,11383,11016,10197,10383,13770,15526,16154,17169,16722,15679,15650,15353,14258,13464,13788,13135,15672,14289,15441,15149,15553,14858,14716,15830,15226,15829,13883,13723,15844,15503,17531,16674,16794,16064,16127,16643],[10451,11499,11028,11001,10656,11094,11332,10806,10372,10741,9395,11305,11049,11578,11175,11821,11113,11140,11660,11054,10893,11049,10286,10751,10949,11821,11810,12413,10866,10967,11814,11210,10750,11180,10361,11493,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[11566,13004,12033,12718,12609,11980,12251,10934,11002,11026,10329,12184,12169,13118,12473,13850,14146,12903,13444,12264,12731,12057,11239,12877,12900,14603,14049,15135,14377,13187,13291,12097,12289,12808,11908,13686,13708,14178,13127,15058,14732,13802,13309,12762,12407,12236,11341,9360,6044,8592,9533,11211,12810,11524,9874,9366,8298,7823,7974,10973,12631,13283,14490,15085,14601,13018,12742,12044,11352,11368,11011,13609,13477,14369,14029,14688,15097,13578,14281,13160,13815,12114,12027,13895,13917,15633,15526,15264,15473,14571,14750],[1567,1697,1706,1801,1711,1619,1507,1426,1337,1321,1341,1544,1648,1840,1759,1846,1807,1633,1624,1427,1315,1405,1374,1419,1536,1888,2058,1993,1701,1593,1644,1445,1438,1362,1411,1581,1626,1795,1656,2078,1749,1799,1541,1389,1370,1391,1328,982,531,717,829,911,930,921,714,757,595,478,588,794,943,947,1285,1384,1115,1146,1027,974,836,879,829,1137,1166,1272,1304,1365,1369,1167,1191,1052,913,978,1078,1134,1061,1298,1547,1325,1288,1330,1201],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,10728,10906,10334,11690,10795,10960,10841,10156,9815,9960,9142,7487,5270,7756,8534,9106,9672,9319,7909,7917,7015,6560,6653,8840,10354,10775,11584,11461,11036,11193,10743,10128,9113,9097,9270,11074,10758,11235,10654,10896,10737,10328,11032,9775,10189,9363,9699,11216,10569,12182,12044,11261,10930,11212,11598]]},"evals":["attrs.interactionModel"],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="seasonal-plots" class="level3">
<h3 class="anchored" data-anchor-id="seasonal-plots">5.2 Seasonal plots</h3>
<p>standard seasonal plot: <code>feasts::gg_season(period)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  feasts<span class="sc">::</span><span class="fu">gg_season</span>(<span class="at">y =</span> Attendances, <span class="at">period =</span> <span class="st">"year"</span>) <span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"All Wales ED Attendances - Seasonal plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>“subseries” seasonal plot: <code>feasts::gg_season(period)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  feasts<span class="sc">::</span><span class="fu">gg_subseries</span>(<span class="at">y =</span> Attendances, <span class="at">period =</span> <span class="st">"year"</span>) <span class="sc">+</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"All Wales ED Attendances - Seasonal subseries plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="time-series-decomposition" class="level2">
<h2 class="anchored" data-anchor-id="time-series-decomposition">5. Time series decomposition</h2>
<p>We run an <strong>STL</strong> (<strong>Seasonal and Trend decomposition using Loess</strong>) model using a formula:</p>
<p><code>MODEL(y ~ predictors)</code></p>
<p>The output is a <strong>dable</strong> (= <strong>decomposition table</strong>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>STLdecomp_AllWales_ts <span class="ot">&lt;-</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">model</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">stl_model =</span> feasts<span class="sc">::</span><span class="fu">STL</span>(</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      Attendances <span class="sc">~</span> <span class="fu">trend</span>(<span class="at">window =</span> <span class="dv">21</span>) <span class="sc">+</span> <span class="fu">season</span>(<span class="at">window =</span> <span class="dv">13</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>STLdecomp_AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">components</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A dable: 91 x 7 [1M]
# Key:     .model [1]
# :        Attendances = trend + season_year + remainder
   .model    MonthYear Attendances  trend season_year remainder season_adjust
   &lt;chr&gt;         &lt;mth&gt;       &lt;int&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;         &lt;dbl&gt;
 1 stl_model  2016 Apr       79246 81016.      -3527.   1757.          82773.
 2 stl_model  2016 May       88058 81167.       4475.   2417.          83583.
 3 stl_model  2016 Jun       84269 81318.       3394.   -443.          80875.
 4 stl_model  2016 Jul       87252 81468.       8254.  -2470.          78998.
 5 stl_model  2016 Aug       85104 81632.       4345.   -872.          80759.
 6 stl_model  2016 Sep       84134 81795.       2817.   -478.          81317.
 7 stl_model  2016 Oct       85177 81958.       2953.    265.          82224.
 8 stl_model  2016 Nov       78154 82117.      -2460.  -1504.          80614.
 9 stl_model  2016 Dec       76731 82277.      -4042.  -1503.          80773.
10 stl_model  2017 Jan       77117 82436.      -5310.     -9.42        82427.
# … with 81 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>STLdecomp_AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">components</span>() <span class="sc">|&gt;</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="forecasting" class="level2">
<h2 class="anchored" data-anchor-id="forecasting">6. Forecasting</h2>
<section id="create-training-and-validation-periods" class="level3">
<h3 class="anchored" data-anchor-id="create-training-and-validation-periods">6.1 Create Training and Validation periods</h3>
<ul>
<li><p><strong>Training set</strong>: from July 2021 to July 2023 (2 years)</p></li>
<li><p><strong>Validation set</strong>: from August 2023 to September 2023 (2 months) –&gt; download updated data and extend to October</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>AllWales_ts <span class="ot">&lt;-</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Type =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Define Training Period</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      MonthYear <span class="sc">&gt;=</span> tsibble<span class="sc">::</span><span class="fu">yearmonth</span>(<span class="st">"2021-07-01"</span>) <span class="sc">&amp;</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>        MonthYear <span class="sc">&lt;=</span> tsibble<span class="sc">::</span><span class="fu">yearmonth</span>(<span class="st">"2023-07-01"</span>) <span class="sc">~</span> <span class="st">"Training"</span>,</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Define Validation Period</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>      MonthYear <span class="sc">&gt;</span> tsibble<span class="sc">::</span><span class="fu">yearmonth</span>(<span class="st">"2023-07-01"</span>) <span class="sc">~</span> <span class="st">"Validation"</span>,</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Data points before Training</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Pre-training"</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Training"</span>,<span class="st">"Validation"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> MonthYear, <span class="at">y =</span> Attendances, <span class="at">colour =</span> Type))<span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"All Wales ED: Split Training/Validation"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="fit-a-model-to-the-training-data" class="level3">
<h3 class="anchored" data-anchor-id="fit-a-model-to-the-training-data">6.2 Fit a model to the Training data</h3>
<p>The fable framework offers a <a href="https://fable.tidyverts.org/reference/index.html">range of popular forecasting models</a>, including:</p>
<ul>
<li>Benchmark models (<code>MEAN</code>, <code>NAIVE</code>, <code>SNAIVE</code>)</li>
<li>ARIMA</li>
<li>ETS</li>
<li>Regression Models (<code>TSLM</code>)</li>
<li>Neural Networks</li>
<li>…</li>
<li>Interface for external libraries: Facebook <a href="https://cran.r-project.org/web/packages/fable.prophet/vignettes/intro.html">Prophet</a> and <a href="https://github.com/mitchelloharawild/fable.tscount">tscount</a> (for count time series)</li>
</ul>
<p>Fitting benchmark models.</p>
<p>Same syntax as when we fitted STL:</p>
<p><code>fabletools::model(MODEL_NAME(y ~ predictors))</code></p>
<p>This creates a list of <strong>mables</strong> (= <strong>model tables</strong>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks <span class="ot">&lt;-</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## select data only from the Training period to fit the models</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Training"</span>)<span class="sc">|&gt;</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">model</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_model =</span> fable<span class="sc">::</span><span class="fu">MEAN</span>(Attendances),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">naive_model =</span> fable<span class="sc">::</span><span class="fu">NAIVE</span>(Attendances),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">snaive_model =</span> fable<span class="sc">::</span><span class="fu">SNAIVE</span>(Attendances <span class="sc">~</span> <span class="fu">lag</span>(<span class="st">"year"</span>))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A mable: 1 x 3
  mean_model naive_model snaive_model
     &lt;model&gt;     &lt;model&gt;      &lt;model&gt;
1     &lt;MEAN&gt;     &lt;NAIVE&gt;     &lt;SNAIVE&gt;</code></pre>
</div>
</div>
<p>Check model’s parameter(s), residuals’ variance, etc …</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks <span class="sc">|&gt;</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(mean_model)<span class="sc">|&gt;</span> </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">report</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Series: Attendances 
Model: MEAN 

Mean: 85623.56 
sigma^2: 55117106.59 </code></pre>
</div>
</div>
<p>Access to</p>
<p>models’ fitted values and residuals</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks <span class="sc">|&gt;</span> </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">augment</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tsibble: 75 x 6 [1M]
# Key:       .model [3]
   .model     MonthYear Attendances .fitted  .resid  .innov
   &lt;chr&gt;          &lt;mth&gt;       &lt;int&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
 1 mean_model  2021 Jul       91935  85624.   6311.   6311.
 2 mean_model  2021 Aug       77147  85624.  -8477.  -8477.
 3 mean_model  2021 Sep       86004  85624.    380.    380.
 4 mean_model  2021 Oct       83889  85624.  -1735.  -1735.
 5 mean_model  2021 Nov       79245  85624.  -6379.  -6379.
 6 mean_model  2021 Dec       72833  85624. -12791. -12791.
 7 mean_model  2022 Jan       73840  85624. -11784. -11784.
 8 mean_model  2022 Feb       72499  85624. -13125. -13125.
 9 mean_model  2022 Mar       87636  85624.   2012.   2012.
10 mean_model  2022 Apr       82066  85624.  -3558.  -3558.
# … with 65 more rows</code></pre>
</div>
</div>
<p>Plot fitted values against historical ones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">augment</span>() <span class="sc">|&gt;</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">.vars =</span> .fitted, <span class="at">lty =</span> <span class="dv">5</span>, <span class="at">size =</span><span class="fl">0.7</span>) <span class="sc">+</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    AllWales_ts <span class="sc">|&gt;</span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(Type <span class="sc">==</span> <span class="st">"Training"</span>),</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">.vars =</span> Attendances, <span class="at">size =</span><span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"All Wales ED: historical vs fitted benchmark values"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plot residual diagnostic plots with <code>feasts::gg_tsresiduals()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks <span class="sc">|&gt;</span> </span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(naive_model) <span class="sc">|&gt;</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  feasts<span class="sc">::</span><span class="fu">gg_tsresiduals</span>(<span class="at">type =</span> <span class="st">"response"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="forecast" class="level3">
<h3 class="anchored" data-anchor-id="forecast">6.3 Forecast</h3>
<p>Use <code>fabletools::forecast(h = horizon)</code> to obtain a <strong>fable</strong> (= <strong>forecast table</strong>) object with <strong>point</strong> and <strong>distribution forecasts</strong> for each model in the mable</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks_fct <span class="ot">&lt;-</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  AllWales_benchmarks <span class="sc">|&gt;</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">forecast</span>(<span class="at">h=</span><span class="dv">2</span>) <span class="do">## h = horizon, 2 months</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks_fct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A fable: 6 x 4 [1M]
# Key:     .model [3]
  .model       MonthYear        Attendances  .mean
  &lt;chr&gt;            &lt;mth&gt;             &lt;dist&gt;  &lt;dbl&gt;
1 mean_model    2023 Aug N(85624, 57321791) 85624.
2 mean_model    2023 Sep N(85624, 57321791) 85624.
3 naive_model   2023 Aug N(94953, 49793420) 94953 
4 naive_model   2023 Sep N(94953, 99586841) 94953 
5 snaive_model  2023 Aug N(90165, 61909635) 90165 
6 snaive_model  2023 Sep N(86320, 61909635) 86320 </code></pre>
</div>
</div>
<p>Plot all models’ <strong>point forecasts</strong> with <strong>prediction intervals</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks_fct <span class="sc">|&gt;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">autoplot</span>(<span class="at">level =</span> <span class="fu">c</span>(<span class="dv">80</span>,<span class="dv">95</span>)) <span class="sc">+</span> <span class="co"># level = prediction intervals</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">autolayer</span>(</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    AllWales_ts <span class="sc">|&gt;</span> <span class="fu">filter</span>(Type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Training"</span>,<span class="st">"Validation"</span>)),</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.vars =</span> Attendances) <span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"All Wales ED: forecasts benchmark models"</span>)<span class="sc">+</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="fu">vars</span>(.model), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">scales =</span> <span class="st">"free_y"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="R-tidyverts-tutorial_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Measure of point forecast accuracy</strong></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>AllWales_benchmarks_fct <span class="sc">|&gt;</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  fabletools<span class="sc">::</span><span class="fu">accuracy</span>(AllWales_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 10
  .model       .type     ME  RMSE   MAE   MPE  MAPE  MASE RMSSE  ACF1
  &lt;chr&gt;        &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1 mean_model   Test   7122. 7122. 7122.  7.68  7.68 0.741 0.505  -0.5
2 naive_model  Test  -2208. 2209. 2208. -2.38  2.38 0.230 0.157  -0.5
3 snaive_model Test   4503  4864. 4503   4.86  4.86 0.469 0.345  -0.5</code></pre>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>